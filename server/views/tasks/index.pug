extends ../layouts/application.pug

block header
  //- Заголовок страницы
  h1.display-4.fw-bold.mt-4= t('views.tasks.title')
  //- Кнопка "Создать статус"
  a.btn.btn-primary(href="/tasks/new")= t('views.tasks.createStatusBtn')

block content
  //- Форма для назначения задач
  .card-shadow
    .card-body.p-4
      form(action="/tasks" method="get")
        .row
          .col-12.col-md
            .input-group.mb-3
              label.input-group-text(for="data_status")= t('views.tasks.status')
              select.form-select(id="data_status" name="status")
                each status in statuses
                  option(value=status.id)= status.name
          
          .col-12.col-md
            .input-group.mb-3
              label.input-group-text(for="data_executor")= t('views.tasks.executor')
              select.form-select(id="data_executor" name="executor")
                each executor in executors
                  option(value=executor.id)= `${executor.firstName} ${executor.lastName}`


          //- Показать только мои задачи
          .mb-3.form-check
            input.form-check-input(type="checkbox" id="data_isCreatorUser" name="isCreatorUser")
            label.form-check-label(for="data_isCreatorUser")= t('views.tasks.onlyMyTasks')

  //- Таблица статусов
  table.table.table-striped
    thead
      tr
        th= t('views.tasks.id')
        th= t('views.tasks.name')
        th= t('views.tasks.status')
        th= t('views.tasks.author')
        th= t('views.tasks.executor')
        th= t('views.tasks.createdAt')
        th= t('views.tasks.actions')
    tbody
      each task in tasks
        tr
          td= task.id
          td
            a(href=`/tasks/${task.id}`)= task.name/a
          td= task.status.name
          td= task.author.firstName + ' ' + task.author.lastName
          td= task.executor.firstName + ' ' + task.executor.lastName
          td= formatDate(task.createdAt)
          td
            .d-flex.flex-wrap
              a.btn.btn-primary.me-1(href=`/tasks/${task.id}/edit`)= t('views.tasks.editBtn')
              form(action=`/tasks/${task.id}` method='post')
                input(type="hidden" name="_method" value="delete")
                input.btn.btn-danger(type="submit" value=t('views.tasks.delete'))
